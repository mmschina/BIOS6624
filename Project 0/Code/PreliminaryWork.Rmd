---
title: "Project 0 - Preliminary Work"
author: "Madelynn Schina"
date: "January 2026"
output: pdf_document
---


```{r, include=F}
knitr::opts_chunk$set(echo = TRUE)

library(knitr)
library(here)
library(dplyr)
library(ggplot2)

```



```{r, echo = F}
# Loading dataset
horomone_data <- read.csv(here("Project 0/Data", "Project0_Clean_v2.csv"))

```


```{r, echo = F}
# Glancing at missingness of variables of interest
horomone_data %>%
  summarise(across(c(Booket..Clock.Time, MEMs..Clock.Time, Cortisol..ug.dl., DHEA..pg.dl.),
                   ~ sum(is.na(.)),
                   .names = "n_missing_{.col}"))

```


```{r, echo = F}
# Preliminary graphs to ascertain any patterns
# Graphing cortisol measurements overtime for each individuals
ggplot(horomone_data, 
       aes(x = interaction(Collection.Date, Collection.Sample),
               y = Cortisol..ug.dl.,
               group = SubjectID,
               color = SubjectID)) +
  geom_line(alpha = 0.6) +
  geom_point(alpha = 0.6) +
  theme_minimal() +
  labs(
    x = "Day / Measurement",
    y = "Cortisol Level",
    title = "Spaghetti Plot of Individual Trajectories"
  ) +
  theme(legend.position = "none")


# Graphing DHEA measurements overtime for each individual
ggplot(horomone_data, 
       aes(x = interaction(Collection.Date, Collection.Sample),
           y = DHEA..pg.dl.,
           group = SubjectID,
           color = SubjectID)) +
  geom_line(alpha = 0.6) +
  geom_point(alpha = 0.6) +
  theme_minimal() +
  labs(x = "Day / Measurement",
       y = "DHEA",
       title = "Spaghetti Plot of Individual Trajectories") +
  theme(legend.position = "none")


```



Potential Questions for the Investigator:
\begin{itemize}
  \item What is the potential range of a typical cortisol and DHEA reading? Did your reading devices produce an error code? (9999.000 for cortisol?)
  \begin{itemize}
    \item Want to be certain when trying to rule out outliers in the case of incorrect measurements by study participants. Was the reading abnormally high and thus should be considered or was it an error and should be handled to not skew results.
  \end{itemize}
\end{itemize}





Notes from Class:
- missing was likely due to unable to read if missing but time was recorded
- interested in time since they woke up, not between spit measurements
- missing data for cap time due to user error
- question 1: scatter plot of the two times against each other, looking for strong correlation/association (ignore missingness) (want a test, also talk about bias)
- 9999 is an error code for missing for cortisol (5 observations)
- question 3: interested in wake-up to last measurement, want expected trends (cortisol should spike and then gradually decline; DHEA should ) What is the increase from wake-up to 30? And then do we see the decline?
- use nmol/L measures for cortisol and DHEA, not the original measures
- question 2: descriptive statistics should be enough; time intervals of interest (adherence window): good adherence - within 7.5 minutes, adequate adherence - within 15 minutes, poor adherence - beyond 15.
- In the nmol units: cortisol range: over 26 is unlikely (don't necessarily remove), over 80 is incorrect (lab error); DHEA range: 5.205 is upper limit of machine, that is also likely an error



Question 1 - Mixed Random Effects Model (Don't average across days); descriptive statistics on the difference between the two times (histogram) (ignore when cap time is missing, give rates)
Question 2 - Use booklet time, average difference across the three days to categorize adherence for the individual. One analysis with cut off being 7.5, another analysis with cut off being 15
Question 3 - Piecewise LMM with knot at 30 minutes


Ignore Clock Time Intervals at all costs, not sure they are calculated right!!!!


